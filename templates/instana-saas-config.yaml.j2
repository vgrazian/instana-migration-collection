# Instana Agent Configuration - SaaS
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

{% if existing_config.com is defined %}
com:
  instana:
    agent:
      backend:
        endpoint:
          host: {{ instana_saas_endpoint }}
          port: {{ instana_saas_port }}
      key: {{ instana_saas_key }}
{% if instana_zone | default('') != '' %}
      zone: {{ instana_zone }}
{% endif %}
{% else %}
backend:
  endpoint:
    host: {{ instana_saas_endpoint }}
    port: {{ instana_saas_port }}
agent:
  key: {{ instana_saas_key }}
{% if instana_zone | default('') != '' %}
  zone: {{ instana_zone }}
{% endif %}
{% endif %}

# Preserved custom configurations
{% for key, value in existing_config.items() %}
{% if key not in ['com', 'backend', 'agent'] %}
{{ key }}: {{ value | to_nice_yaml | indent(2) }}
{% endif %}
{% endfor %}